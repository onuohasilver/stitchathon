import 'dart:math';

import 'package:dart_jsonwebtoken/dart_jsonwebtoken.dart';

signJwt(String privateKey) {
  final int daate = DateTime.now().millisecondsSinceEpoch;

  final jwt = JWT(
    {
      'aud': 'https://secure.stitch.money/connect/token',
      'iss': clientId,
      'sub': clientId,
      'jti': Random().nextInt(50000000),
      'iat': daate,
      'nbf': "0",
      'exp': DateTime(2022, 2, 20).millisecondsSinceEpoch,
    },
    header: {
      "alg": "RS256",
      "typ": "JWT",
      "kid": "20C08BA14B7CD7E7EC5B2B95694B407CB5845651"
    },
  );

  String clientAssertion = jwt.sign(RSAPrivateKey(privateKey),
      algorithm: JWTAlgorithm.RS256, expiresIn: const Duration(seconds: 100));
  return clientAssertion;
}

/////
/////
///
///
///
///
///
///
///
///
///
///
///
///

String clientId = 'test-075b3ce1-5790-4d2f-8a9b-af24c3b45951';

String keyID = '''
-----BEGIN CERTIFICATE-----
MIIE/DCCAuSgAwIBAgIJAMx9D4brhWJZMA0GCSqGSIb3DQEBCwUAMBQxEjAQBgNVBAMTCUFMZ28g
VGVzdDAeFw0yMjAyMTgwODMxMzVaFw0yNDAyMTkwODMxMzVaMBQxEjAQBgNVBAMTCUFMZ28gVGVz
dDCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAOkmZyN07Kmo1HbbetzJ6OSTIRJhlWKt
4plGNO3Nf5uDJ88/aNCO6+cSGLwK02nw8Ou6tas92a9xKBvL5QT6qvpU/DDQBVmHBSl+EySLVaES
vtndNFN4Cd/fccKqyVC3Y6Luw5DhZYKlgenNOKzWP7cM3RkcPRtsAmwxSWD9qSJynRDVCURSo/pJ
XHsRhiHoUnFjwCEq+yZ/CVZYX/6gYAHgKSJS3r858e1BssmXyYmJcpkWorGuyGmm7MM+x52p0YqQ
z/xfnSEdxwOY6AxVKlPNIiiMulrJ4SMfoYNHM0OS5h48SIgP6HC9YqaWP/aFRpv2QqwiDQK5+R3E
9DAl+1Cez4wEGU0kmm7wY6985066EchCg2WSasbTGxQCCMiK6jVd7YtCzIDMdH3Q63EaHjNWhJ+W
F3UC3iXss78NiEE9hIy4J0L+7OOwFDgnBS6sMgtLWBuGX3rANmQRi2pml484JaK2ZwmggShEWwoB
e+cHaSHnDMl2XQI2yzTEVhP4OctHTMx+8f+ZjJXc98bMbFZV2x1EUaUiS9hqPje73pDt+v/HCTj8
CW7P7pMRNA7YbuBzCDdzVeN+un1m4A6FQHbEmq34tb7R9xYufwJAys8MnLplD96i7iNBPNnzLclk
geI+qI0HgRf5+HkZ2FSj3F9fBaao/WaJj9rhiRm8MAnRAgMBAAGjUTBPMAkGA1UdEwQCMAAwCwYD
VR0PBAQDAgbAMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMIMB0GA1UdDgQWBBRXwae8bdsCz54GwnC/
enhaZxChIzANBgkqhkiG9w0BAQsFAAOCAgEAEkM09NJTUSfBKNPPrNHOPdKESsfUTwKc+ZSbXdPb
YTT895ahw2iUpmN+w10LzntMwpzQio68JouWDDgbRxVmCiwZq4HFdxJupKsc4w2/PIyUIhjvz6rJ
QvSskD7oobZL/CBbVXixLmL3tE4orB8v894bFSW0hTFyZ5BQ5JHn5RJ5saS0h9pS+mGbHNTjjU7q
XQ8Z/nKS597LOr7y1s/6Gf5zJ9fkLPOb36V/gaLXTru+cGc7l7G6rtkjeeyONqAdDCrU6Wp/MhXJ
9ZYB86OIYr9k7+J87rQzb68vWQoRM2bdXHx4qrZCX/NhUowfuEPmsR8tXDF/x7+5ATgpH8qV6pS3
KbebGnB6OVPa7+F10CqJ3zZShFu2VkDbm/aZYH2y3FTGcX6aV3NWRXWoRxSpCytj2FL8y8MuL8NE
1TPIkLAzYs4Y73yNqZdgVaygQuVYqGy5iKxWQDPeEWFmZOGyhOfRWbGu9OJKlJ9vmZJNisYT5Zgh
wSEeHh9ldjEv88iUnwbq+CzI/w/4xvWiFMnlNX/rIX/8+HlfXaGP01VsVJ3SlzR2j+XMbxpF6BEY
D9COte5HF+x7VU7XDnJe2sZrqIne3EfIXWDEgNB6n8ETG9hjTP6a7VF2Ljt5QQzuq8/IULW+OKcd
lhpfvAv/p0zRKxiSWX6dRrOXUQHoJKKPQKI=
-----END CERTIFICATE-----
''';

String privateKey = '''
    -----BEGIN PRIVATE KEY-----
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
-----END PRIVATE KEY-----

    ''';
